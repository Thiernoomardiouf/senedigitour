var sowb=window.sowb||{};jQuery((function(i){sowb.setupCarousel=function(){i.fn.setSlideTo=function(s){$item=i(this);var e=$item.slick("slickGetOption","slidesToShow"),o=$item.slick("slickGetOption","slidesToScroll");$item.slick("slickSetOption","slidesToShow",1),$item.slick("slickSetOption","slidesToScroll",1),$item.slick("slickGoTo",s),$item.slick("slickSetOption","slidesToShow",e),$item.slick("slickSetOption","slidesToScroll",o)},i(".sow-carousel-wrapper").each((function(){var s=i(this),e=s.find(".sow-carousel-items"),o=s.data("responsive"),t=s.data("carousel_settings");e.not(".slick-initialized").slick({arrows:!1,dots:t.dots,rows:0,rtl:"rtl"==s.data("dir"),touchThreshold:20,infinite:!s.data("ajax-url")&&s.data("carousel_settings").loop,variableWidth:s.data("variable_width"),accessibility:!1,cssEase:t.animation,speed:t.animation_speed,autoplay:t.autoplay,autoplaySpeed:t.autoplaySpeed,pauseOnHover:t.pauseOnHover,slidesToScroll:o.desktop_slides_to_scroll,slidesToShow:void 0===o.desktop_slides_to_show?o.desktop_slides_to_scroll:o.desktop_slides_to_show,responsive:[{breakpoint:o.tablet_portrait_breakpoint,settings:{slidesToScroll:o.tablet_portrait_slides_to_scroll,slidesToShow:void 0===o.tablet_portrait_slides_to_show?o.tablet_portrait_slides_to_scroll:o.tablet_portrait_slides_to_show}},{breakpoint:o.mobile_breakpoint,settings:{slidesToScroll:o.mobile_slides_to_scroll,slidesToShow:void 0===o.mobile_slides_to_show?o.mobile_slides_to_scroll:o.mobile_slides_to_show}}]}),t.item_overflow&&(e.css("width",""),e.css("opacity","")),e.on("swipe",(function(i,e,o){s.parent().parent().find(".sow-carousel-"+("left"==o?"next":"prev")).trigger("touchend")})),s.parent().parent().find(".sow-carousel-previous, .sow-carousel-next").on("click touchend",(function(e,o){e.preventDefault();var t=s.find(".sow-carousel-items"),l=t.find(".sow-carousel-item").length,a=l>=s.data("item_count"),c=Math.ceil(t.outerWidth()/t.find(".sow-carousel-item").outerWidth(!0)),r=t.slick("slickGetOption","slidesToScroll"),n=l-c;"post"==s.data("widget")&&n++,a||(t.slick("slickCurrentSlide")+c>=l-1||t.slick("slickCurrentSlide")+r>n)&&i(sowb).trigger("carousel_load_new_items",[s,t,o]),i(this).hasClass("sow-carousel-next")?a&&t.slick("slickCurrentSlide")>=n?s.data("carousel_settings").loop&&t.slick("slickGoTo",0):t.slick("slickCurrentSlide")+r>n?t.setSlideTo(n):t.slick("slickNext"):i(this).hasClass("sow-carousel-previous")&&(s.data("carousel_settings").loop&&0==t.slick("slickCurrentSlide")?t.slick("slickGoTo",n):t.slick("slickPrev"))})),t.dots&&s.data("variable_width")&&(s.find(".slick-dots li").off("click.slick"),s.find(".slick-dots li").on("click touchend",(function(){var s=i(this).index(),o=e.find(".sow-carousel-item").length,t=Math.ceil(e.outerWidth()/e.find(".sow-carousel-item").outerWidth(!0)),l=o-t;s+t>=o?(e.slick("slickGoTo",l),$dots=i(this).parent(),$dots.find(".slick-active").removeClass("slick-active"),$dots.children().eq(s).addClass("slick-active")):e.slick("slickGoTo",s)})))})),i(sowb).trigger("carousel_setup"),i(document).on("keydown",".sow-carousel-navigation a",(function(s){13!=s.keyCode&&32!=s.keyCode||(s.preventDefault(),i(this).trigger("click"))})),i(document).on("keyup",".sow-carousel-item",(function(s){if(13==s.keyCode&&i(this).find("h3 a")[0].click(),37==s.keyCode||39==s.keyCode){var e=i(this).parents(".sow-carousel-wrapper"),o=e.find(".sow-carousel-items"),t=o.find(".sow-carousel-item").length,l=i(this).data("slick-index"),a=t-(t===e.data("item_count")?0:1);if(37==s.keyCode)--l<0&&(l=a);else if(39==s.keyCode&&++l>=a){if(e.data("fetching"))return;e.parent().find(".sow-carousel-next").trigger("click",!0)}o.slick("slickGoTo",l,!0),e.find(".sow-carousel-item").prop("tabindex",-1),e.find('.sow-carousel-item[data-slick-index="'+l+'"]').trigger("focus").prop("tabindex",0)}})),i(window).on("resize load",(function(){i(".sow-carousel-wrapper").each((function(){var s=i(this),e=s.find(".sow-carousel-items.slick-initialized"),o=Math.ceil(e.outerWidth()/e.find(".sow-carousel-item").outerWidth(!0)),t=s.parent().parent().find(".sow-carousel-navigation");o>=s.data("item_count")?(t.hide(),e.slick("slickSetOption","touchMove",!1),e.slick("slickSetOption","draggable",!1)):t.not(":visible")&&(t.show(),e.slick("slickSetOption","touchMove",!0),e.slick("slickSetOption","draggable",!0));var l=s.data("responsive");window.matchMedia("(min-width: "+l.tablet_portrait_breakpoint+"px) and (max-width: "+l.tablet_landscape_breakpoint+"px) and (orientation: landscape)").matches&&(e.slick("slickSetOption","slidesToShow",l.tablet_landscape_slides),e.slick("slickSetOption","slidesToScroll",l.tablet_landscape_slides))})),i(".sow-carousel-item:first-of-type").prop("tabindex",0)}))},sowb.setupCarousel(),i(sowb).on("setup_widgets",sowb.setupCarousel)})),window.sowb=sowb;